<div class="flex flex-col w-full px-2 sm:px-7 md:px-16 bg-primary">
  <div class="flex flex-col md:flex-row w-full p-4 rounded-t-xl gap-2">

    <!-- <div class="flex flex-wrap w-full p-4 pb-3 rounded-t-xl gap-2">
      <div class="flex flex-row w-full">
        <input
          type="text"
          placeholder="Search here (title, author, year, accession number)"
          class="input input-bordered w-1/2 rounded-xl text-lg font-medium text-primary slide-in-left bg-white"
          [(ngModel)]="searchTerm"
          (input)="onSearch()"/>
        <button
          type="button"
          class="w-40 bg-white text-primary px-4 py-3 rounded-xl font-medium hover:bg-[#ffb700] hover:text-black transition duration-300 mb-1 ml-2 slide-in-right"
          (click)="clearSearch()"
        >
          Clear
        </button>
      </div>

      <div class="flex flex-row gap-2 slide-in-right mt-1">
        <div class="dropdown dropdown-bottom slide-in-right">
          <div
            tabindex="0"
            role="button"
            class="btn w-auto mb-1 mx-2 bg-secondary border-none text-black text-lg hover:bg-[#ffb700]"
          >
            {{ categoryPlaceholder }}
          </div>
          <ul
            tabindex="0"
            class="dropdown-content menu bg-secondary rounded-box z-[1] w-52 p-2 shadow text-lg font-medium text-black"
          >
            <li *ngFor="let category of categories">
              <a (click)="CategoryPlaceholder(category.mat_type)">
                {{ category.mat_type }}
              </a>
            </li>
          </ul>
        </div>
      </div>

      <div class="flex justify-between items-center gap-5 slide-in-right">
        <span class="text-lg font-medium ml-3 text-white">
          Page {{ currentPage }} / {{ totalPages }}
        </span>
        <div class="flex gap-2">
          <button
            class="btn border-none bg-secondary text-black hover:bg-primary-focus hover:bg-white hover:text-[#801e1d]"
            [disabled]="currentPage === 1"
            (click)="onPageChange(currentPage - 1)"
          >
            Previous
          </button>
          <button
            class="btn border-none bg-secondary text-black hover:bg-primary-focus hover:bg-white hover:text-[#801e1d]"
            [disabled]="currentPage === totalPages"
            (click)="onPageChange(currentPage + 1)"
          >
            Next
          </button>
        </div>
      </div>
    </div> -->

    <div class="flex flex-row flex-wrap w-full mt-1 justify-between gap-1">
      <div class="flex flex-row w-full md:w-1/2 gap-2">
        <input 
        type="text" 
        placeholder="Search here" 
        class="input input-bordered w-full rounded-xl text-lg font-medium 
               text-primary slide-in-left bg-white"
        [(ngModel)]="searchTerm"
        (input)="onSearch()" />
      
      <button
        type="button"
        class="h-[3rem] bg-white text-primary rounded-xl px-4 font-medium 
               hover:bg-[#ffb700] hover:text-black transition duration-300 slide-in-right"
        (click)="clearSearch()"
      >
        Clear
      </button>
        </div>
        
      <div class="flex flex-row w-auto flex-wrap">
        <div class="flex flex-row gap-2 slide-in-right mt-1">
          <div class="dropdown dropdown-bottom slide-in-right">
            <div
              tabindex="0"
              role="button"
              class="btn w-auto mb-1 mx-2 bg-secondary border-none text-black text-lg hover:bg-[#ffb700]"
            >
              {{ categoryPlaceholder }}
            </div>
            <ul
              tabindex="0"
              class="dropdown-content menu bg-secondary rounded-box z-[1] w-52 p-2 shadow text-lg font-medium text-black"
            >
              <li *ngFor="let category of categories">
                <a (click)="CategoryPlaceholder(category.mat_type)">
                  {{ category.mat_type }}
                </a>
              </li>
            </ul>
          </div>
        </div>

          <div class="flex justify-between items-center gap-5 slide-in-right">
            <span class="text-lg font-medium ml-3 text-white">
              Page {{ currentPage }} / {{ totalPages }}
            </span>
            <div class="flex gap-2">
              <button
                class="btn border-none bg-secondary text-black hover:bg-primary-focus hover:bg-white hover:text-[#801e1d]"
                [disabled]="currentPage === 1"
                (click)="onPageChange(currentPage - 1)"
              >
                Previous
              </button>
              <button
                class="btn border-none bg-secondary text-black hover:bg-primary-focus hover:bg-white hover:text-[#801e1d]"
                [disabled]="currentPage === totalPages"
                (click)="onPageChange(currentPage + 1)"
              >
                Next
              </button>
              </div>
          </div>
      </div>
    </div>

  </div>

  @if (materials.length >0 ) {
    <div class="p-4 bg-white text-black rounded-xl w-full overflow-x-auto slide-in-right mb-5">
      <table class="table w-full text-xs md:text-sm">
        <thead>
          <tr class="text-primary text-center">
            <th (click)="sortMaterials('accnum')">
              Accession Number ↕
              <span *ngIf="sortField === 'accnum'" class="sort-arrow">
                <ng-container *ngIf="sortOrder === 'ASC'">↑</ng-container>
                <ng-container *ngIf="sortOrder === 'DESC'">↓</ng-container>
              </span>
            </th>
            <th (click)="sortMaterials('title')">
              Title ↕
              <span *ngIf="sortField === 'title'" class="sort-arrow">
                <ng-container *ngIf="sortOrder === 'ASC'">↑</ng-container>
                <ng-container *ngIf="sortOrder === 'DESC'">↓</ng-container>
              </span>
            </th>
            <th (click)="sortMaterials('author')">
              Author ↕
              <span *ngIf="sortField === 'author'" class="sort-arrow">
                <ng-container *ngIf="sortOrder === 'ASC'">↑</ng-container>
                <ng-container *ngIf="sortOrder === 'DESC'">↓</ng-container>
              </span>
            </th>
            <th (click)="sortMaterials('subj')">
              Subject ↕
              <span *ngIf="sortField === 'subj'" class="sort-arrow">
                <ng-container *ngIf="sortOrder === 'ASC'">↑</ng-container>
                <ng-container *ngIf="sortOrder === 'DESC'">↓</ng-container>
              </span>
            </th>
            <th (click)="sortMaterials('copyright')">
              Copyright ↕
              <span *ngIf="sortField === 'copyright'" class="sort-arrow">
                <ng-container *ngIf="sortOrder === 'ASC'">↑</ng-container>
                <ng-container *ngIf="sortOrder === 'DESC'">↓</ng-container>
              </span>
            </th>
            <th (click)="sortMaterials('callno')">
              Call number ↕
              <span *ngIf="sortField === 'callno'" class="sort-arrow">
                <ng-container *ngIf="sortOrder === 'ASC'">↑</ng-container>
                <ng-container *ngIf="sortOrder === 'DESC'">↓</ng-container>
              </span>
            </th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody class="text-start text-sm">
          <tr *ngFor="let material of materials; trackBy: trackByAccNum">
            <td>{{ material.accnum }}</td>
            <td>
              <a
                [routerLink]="['/borrow-info', material.accnum]"
                class="text-primary font-semibold hover:text-[#ffb700] hover:underline"
              >
                {{ material.title }}
              </a>
            </td>
            <td>
              {{ material.author | slice: 0: 50 }}
              {{ material.author.length > 50 ? '...' : '' }}
            </td>
            <td>{{ material.subj }}</td>
            <td>{{ material.copyright }}</td>
            <td>
              {{ material.callno | slice: 0: 11 }}
              {{ material.callno.length > 11 ? '...' : '' }}
            </td>
            <td>{{ material.status }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  } @else {
    <div class="flex justify-center items-center mt-20 slide-in-below">
      <div class="card bg-primary w-96">
          <figure class="px-10 pt-10">
            <img
              src="../../../assets/no-match1.svg"
              alt="no-match"/>
          </figure>
          <div class="card-body items-center text-center">
            <h2 class="card-title text-white">Nothing match your search!</h2>
            <p class="text-white">Didn't find what you're looking for?</p>
          </div>
        </div>
    </div>
  }

</div>
