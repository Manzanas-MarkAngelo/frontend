<div class="flex justify-center items-center w-auto px-2 md:px-10 pt-20 
            bg-primary">
  <div class="bg-white p-8 rounded-xl shadow-lg w-full md:w-3/4 h-full 
              slide-in-right">
    <div class="flex items-end justify-between">
      <h1 class="text-2xl text-primary font-semibold ml-2 mb-5">
        Material details
      </h1>
    </div>
    <form (ngSubmit)="onSubmit()">
      <div class="mb-4 mt-1 flex items-center space-x-4">
        <div class="relative w-1/2">
          <input
            readonly
            id="title"
            name="title"
            type="text"
            class="floating-input w-full mt-1 rounded-full border border-gray-300 
                   px-3 pl-6 py-2 focus:ring-opacity-50 text-lg"
            [(ngModel)]="material.title"
          />
          <label for="title" class="floating-label">Title</label>
        </div>
        <div class="relative w-1/2">
          <input
            readonly
            id="heading"
            name="heading"
            type="text"
            class="floating-input w-full mt-1 rounded-full border border-gray-300 
                   px-3 pl-6 py-2 focus:ring-opacity-50 text-lg"
            [(ngModel)]="material.subject_name"
          />
          <label for="heading" class="floating-label">Subject Heading</label>
        </div>
      </div>

      <div class="mb-4 mt-1 flex items-center space-x-4">
        <div class="relative w-1/2">
          <input
            readonly
            id="accnum"
            name="accnum"
            type="text"
            class="floating-input w-full mt-1 rounded-full border border-gray-300 
                   px-3 pl-6 py-2 focus:ring-opacity-50 text-lg"
            [(ngModel)]="material.accnum"
          />
          <label for="accnum" class="floating-label">Accession number</label>
        </div>
        <div class="relative w-1/2">
          <input
            readonly
            id="category"
            name="category"
            type="text"
            class="floating-input w-full mt-1 rounded-full border border-gray-300 
                   px-3 pl-6 py-2 focus:ring-opacity-50 text-lg"
            [(ngModel)]="material.category"
          />
          <label for="category" class="floating-label">Category</label>
        </div>
      </div>

      <div class="mb-4 mt-1 flex items-center space-x-4">
        <div class="relative w-1/2">
          <input
            readonly
            id="author"
            name="author"
            type="text"
            class="floating-input w-full mt-1 rounded-full border border-gray-300 
                   px-3 pl-6 py-2 focus:ring-opacity-50 text-lg"
            [(ngModel)]="material.author"
          />
          <label for="author" class="floating-label">Author</label>
        </div>
        <div class="relative w-1/2">
          <input
            readonly
            id="callnum"
            name="callnum"
            type="text"
            class="floating-input w-full mt-1 rounded-full border border-gray-300 px-3 pl-6 py-2 focus:ring-opacity-50 text-lg"
            [(ngModel)]="material.callno"
          />
          <label for="callnum" class="floating-label">Call number</label>
        </div>
      </div>

      <div class="mb-4 mt-1 flex items-center space-x-4">
        <div class="relative w-1/2">
          <input
            readonly
            id="copyright"
            name="copyright"
            type="text"
            class="floating-input w-full mt-1 rounded-full border border-gray-300 
                   px-3 pl-6 py-2 focus:ring-opacity-50 text-lg"
            [(ngModel)]="material.copyright"
          />
          <label for="copyright" class="floating-label">Copyright</label>
        </div>
        <div class="relative w-1/2">
          <input
            readonly
            id="publisher"
            name="publisher"
            type="text"
            class="floating-input w-full mt-1 rounded-full border border-gray-300 
                   px-3 pl-6 py-2 focus:ring-opacity-50 text-lg"
            [(ngModel)]="material.publisher"
          />
          <label for="publisher" class="floating-label">Publisher</label>
        </div>
      </div>

      <div class="mb-4 mt-1 flex items-center space-x-4">
        <div class="relative w-1/2">
          <input
            readonly
            id="edition"
            name="edition"
            type="text"
            class="floating-input w-full mt-1 rounded-full border border-gray-300 
                   px-3 pl-6 py-2 focus:ring-opacity-50 text-lg"
            [(ngModel)]="material.edition"
          />
          <label for="edition" class="floating-label">Edition</label>
        </div>
        <div class="relative w-1/2">
          <input
            readonly
            id="isbn"
            name="isbn"
            type="text"
            class="floating-input w-full mt-1 rounded-full border border-gray-300 
                   px-3 pl-6 py-2 focus:ring-opacity-50 text-lg"
            [(ngModel)]="material.isbn"
          />
          <label for="isbn" class="floating-label">ISBN</label>
        </div>
      </div>

      <div class="mb-4 mt-1 flex items-center space-x-3">
        <div class="relative w-1/2">
          <input
            readonly
            id="status"
            name="status"
            type="text"
            class="floating-input w-full mt-1 rounded-full border border-gray-300 
                   px-3 pl-6 py-2 focus:ring-opacity-50 text-lg"
            [(ngModel)]="material.status"
          />
          <label for="status" class="floating-label">Status</label>
        </div>
        <div class="relative w-1/2">
          <input
            id="idnum"
            name="idnum"
            type="text"
            class="floating-input w-full mt-1 rounded-full border border-gray-300 
                   px-3 py-2 focus:ring-opacity-50 text-lg"
            [(ngModel)]="idNumber"
            [readonly]="!!material.borrower_id"
            required
          />
          <label for="idnum" class="floating-label">ID number (Borrower)</label>
        </div>
      </div>

      <div class="mb-4 mt-1 flex items-center space-x-1.5 justify-end">
        <button
          routerLink="/borrow"
          type="button"
          class="w-1/5 bg-primary text-white px-4 py-3 rounded-xl font-medium 
                 hover:bg-[#ffb700] hover:text-black transition duration-300 
                 mt-0.5"
        >
          Back
        </button>
        @if (material.status !== 'Charged') {
          <!-- Borrow button only if the material is not charged -->
          <button
            type="submit"
            class="w-[29%] bg-secondary text-black px-4 py-3 rounded-xl 
                   font-medium hover:bg-[#801e1d] hover:text-white transition 
                   duration-300 mt-0.5"
          >
            Borrow
          </button>
        }
      </div>
    </form>
  </div>
</div>

@if(showConfirmationModal){
  <div class="fixed inset-0 flex items-center justify-center bg-gray-800 
              bg-opacity-50 z-50">
    <div class="bg-white p-8 rounded-3xl shadow-lg w-1/2 max-w-md">
      <h2 class="text-center text-2xl font-medium text-primary mb-3">
        Confirm Borrowing
      </h2>
      <div class="flex flex-col items-center justify-between h-full">
        <img 
          src="../../../assets/return.jpg" 
          alt="Book Return" 
          class="w-4/5 h-auto mb-4" 
        />
        <div class="flex flex-col space-y-4 text-center">
          <div class="text-yellow-500 italic text-lg">
            {{ material.title }}
          </div>
          <div class="font-medium text-lg mb-4">
            Author: {{ material.author }}
          </div>

          <div class="flex flex-col items-center">
            <div class="relative">
              <span class="text-lg font-medium">{{ idNumber }}</span>
              <div 
                class="absolute left-[-10px] right-[-10px] bottom-[-4px] 
                       h-[2px] bg-black">
              </div>
            </div>
            <div class="text-sm italic mt-1">Borrower's ID Number</div>
          </div>
        </div>
        <div class="flex flex-row gap-4 w-full mt-4">
          <button
            (click)="closeConfirmationModal()"
            class="flex-1 bg-primary text-white px-6 py-3 rounded-xl font-medium 
                  hover:bg-[#ffb700] hover:text-black transition duration-300"
          >
            Back
          </button>
          <button
            (click)="confirmBorrowing()"
            class="flex-1 bg-secondary text-black px-6 py-3 rounded-xl 
                  font-medium hover:bg-[#801e1d] hover:text-white transition 
                  duration-300">
            Confirm
          </button>
        </div>
      </div>
    </div>
  </div>
}

@if (isProcessing) {
  <div class="fixed inset-0 flex items-center justify-center bg-black 
              bg-opacity-50 z-50">
    <div class="flex flex-col items-center">
      <img 
        src="../../../assets/spinning-dots.svg" 
        alt="Loading" 
        class="w-16 h-16 animate-spin" 
      />
      <p class="text-white text-lg mt-4">
        Processing, please wait...
      </p>
    </div>
  </div>
}

<app-snackbar/>